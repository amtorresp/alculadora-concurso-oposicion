import React, { useState, useEffect } from 'react';
import { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/card';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';

const CalculadoraOposicion = () => {
  const [correctas, setCorrectas] = useState('');
  const [incorrectas, setIncorrectas] = useState('');
  const [blanco, setBlanco] = useState('');
  const [puntuacion, setPuntuacion] = useState(null);
  const [error, setError] = useState('');

  const TOTAL_PREGUNTAS = 100;
  const PENALIZACION = 1/3;

  useEffect(() => {
    const numCorrectas = parseInt(correctas) || 0;
    const numIncorrectas = parseInt(incorrectas) || 0;
    const numBlanco = parseInt(blanco) || 0;

    if (numCorrectas + numIncorrectas + numBlanco > TOTAL_PREGUNTAS) {
      setError(`El total de preguntas no puede superar ${TOTAL_PREGUNTAS}`);
      setPuntuacion(null);
      return;
    }

    if (numCorrectas < 0 || numIncorrectas < 0 || numBlanco < 0) {
      setError('Los valores no pueden ser negativos');
      setPuntuacion(null);
      return;
    }

    setError('');
    const puntuacionCalculada = numCorrectas - (numIncorrectas * PENALIZACION);
    setPuntuacion(puntuacionCalculada);
  }, [correctas, incorrectas, blanco]);

  return (
    <Card className="w-full max-w-md mx-auto">
      <CardHeader>
        <CardTitle className="text-center">Calculadora de Examen</CardTitle>
      </CardHeader>
      <CardContent className="space-y-4">
        <div className="space-y-2">
          <Label htmlFor="correctas">Preguntas Correctas:</Label>
          <Input
            id="correctas"
            type="number"
            value={correctas}
            onChange={(e) => setCorrectas(e.target.value)}
            placeholder="0"
            min="0"
            max="100"
          />
        </div>

        <div className="space-y-2">
          <Label htmlFor="incorrectas">Preguntas Incorrectas:</Label>
          <Input
            id="incorrectas"
            type="number"
            value={incorrectas}
            onChange={(e) => setIncorrectas(e.target.value)}
            placeholder="0"
            min="0"
            max="100"
          />
        </div>

        <div className="space-y-2">
          <Label htmlFor="blanco">Preguntas en Blanco:</Label>
          <Input
            id="blanco"
            type="number"
            value={blanco}
            onChange={(e) => setBlanco(e.target.value)}
            placeholder="0"
            min="0"
            max="100"
          />
        </div>

        {error && (
          <div className="text-red-500 text-sm mt-2">
            {error}
          </div>
        )}

        {puntuacion !== null && !error && (
          <div className="mt-4 p-4 bg-gray-100 rounded-lg">
            <div className="text-center">
              <div className="font-semibold">Puntuaci√≥n Final:</div>
              <div className="text-2xl font-bold text-blue-600">
                {puntuacion.toFixed(2)}
              </div>
            </div>
          </div>
        )}

        <div className="text-xs text-gray-500 mt-4">
          <ul className="list-disc pl-4 space-y-1">
            <li>Correctas: +1 punto</li>
            <li>Incorrectas: -{PENALIZACION} puntos</li>
            <li>En blanco: 0 puntos</li>
            <li>Total preguntas: {TOTAL_PREGUNTAS}</li>
          </ul>
        </div>
      </CardContent>
    </Card>
  );
};

export default CalculadoraOposicion;
